#View(filtered_rep_df)
#bill_df_specific <- bill_df_specific %>%
#select(bill_id, short_title, sponsor, sponsor_state, sponsor_party, govtrack_url, active)
#View(bill_df_specific)
filtered_rep_df<- filter(representative_df, first_name == first_name_l)
selected_rep_df<- select(filtered_rep_df, id, first_name, last_name, state, district, party, twitter_account, phone)
print(selected_rep_df)
return(selected_rep_df)
}
representative_info<- get_representative_info("nana")
View(representative_info)
get_representative_info <- function(legislator) {
#GET https://api.propublica.org/congress/v1/{congress}/{chamber}/members.json
#Construct search query using congress 116
base_uri<- "https://api.propublica.org/congress/v1/116/house/members.json"
#endpoint<- paste0(specific_bill_id, ".json")
#uri<- paste0(base_uri, endpoint)
response <- GET(base_uri, add_headers('X-API-Key' = propublica_key))
response_text <- content(response, "text")
text_format <- fromJSON(response_text)
#Create data frame
representative_df<- as.data.frame(text_format$results$members)
representative<- "Alexandria Ocasio-Cortez"
representative_split<- strsplit(representative, " ")
representative_split<- unlist(representative_split)
print(representative_split)
class(representative_split)
first_name_l<- representative_split[1]
last_name_l<- representative_split[2]
print(first_name_l)
print(last_name_l)
#filtered_rep_df<- filter(representative_df, first_name == first_name & last_name == last_name)
#View(filtered_rep_df)
#bill_df_specific <- bill_df_specific %>%
#select(bill_id, short_title, sponsor, sponsor_state, sponsor_party, govtrack_url, active)
#View(bill_df_specific)
filtered_rep_df<- filter(representative_df, first_name == first_name_l & last_name == last_name_l)
selected_rep_df<- select(filtered_rep_df, id, first_name, last_name, state, district, party, twitter_account, phone)
print(selected_rep_df)
return(selected_rep_df)
}
representative_info<- get_representative_info("nana")
View(representative_info)
recent_votes<- GET(https://api.propublica.org/congress/v1/house/votes/recent.json, add_headers('X-API-Key' = propublica_key))
recent_votes<- GET(https://api.propublica.org/congress/v1/house/votes/recent.json, add_headers('X-API-Key' = propublica_key))
recent_uri<- "https://api.propublica.org/congress/v1/house/votes/recent.json"
recent_votes<- GET(recent_uri, add_headers('X-API-Key' = propublica_key))
library(jsonlite)
recent_votes<- GET(recent_uri, add_headers('X-API-Key' = propublica_key))
library(httr)
library(jsonlite)
library(dplyr)
library(tidyr)
percentage_other<- function(
base_uri<- paste0("https://api.propublica.org/congress/v1/members/", rep_id, "/bills/introduced.json")
response <- GET(base_uri, add_headers('X-API-Key' = propublica_key))
response_text <- content(response, "text")
text_format <- fromJSON(response_text)
#Create data frame
rep_bill_df<- as.data.frame(text_format$results$bills)
selected_rep_bill_df<- select(rep_bill_df, bill_id, title)
#print(selected_rep_bill_df)
return(selected_rep_bill_df)
}
#intro_bills_df<-get_representative_bills("J000298")
#View(intro_bills_df)
)
recent_votes<- GET(recent_uri, add_headers('X-API-Key' = propublica_key))
recent_votes<- as.data.frame(recent_votes)
percentage_other<- function(rep_id) {
uri_recent<- "https://api.propublica.org/congress/v1/house/votes/recent.json")
response_recent <- GET(uri_recent, add_headers('X-API-Key' = propublica_key))
response_text_recent <- content(response, "text")
text_format_recent <- fromJSON(response_text)
#Create data frame
recent_votes<- as.data.frame(text_format_recent$results)
#selected_rep_bill_df<- select(rep_bill_df, bill_id, title)
#print(selected_rep_bill_df)
#return(selected_rep_bill_df)
}
percentage_other<- function(rep_id) {
uri_recent<- "https://api.propublica.org/congress/v1/house/votes/recent.json")
response_recent <- GET(uri_recent, add_headers('X-API-Key' = propublica_key))
response_text_recent <- content(response, "text")
text_format_recent <- fromJSON(response_text)
#Create data frame
recent_votes<- as.data.frame(text_format_recent$results)
#selected_rep_bill_df<- select(rep_bill_df, bill_id, title)
#print(selected_rep_bill_df)
return(recent_votes)
}
percentage_other<- function(rep_id) {
uri_recent<- "https://api.propublica.org/congress/v1/house/votes/recent.json")
response_recent <- GET(uri_recent, add_headers('X-API-Key' = propublica_key))
response_text_recent <- content(response, "text")
text_format_recent <- fromJSON(response_text)
#Create data frame
recent_votes<- as.data.frame(text_format_recent$results)
#selected_rep_bill_df<- select(rep_bill_df, bill_id, title)
#print(selected_rep_bill_df)
return(recent_votes)
}
recent_votes<- as.data.frame(text_format_recent$results)
percentage_other<- function(rep_id) {
uri_recent<- "https://api.propublica.org/congress/v1/house/votes/recent.json")
response_recent <- GET(uri_recent, add_headers('X-API-Key' = propublica_key))
response_text_recent <- content(response, "text")
text_format_recent <- fromJSON(response_text)
#Create data frame
recent_votes<- as.data.frame(text_format_recent$results)
#selected_rep_bill_df<- select(rep_bill_df, bill_id, title)
#print(selected_rep_bill_df)
return(recent_votes)
}
#selected_rep_bill_df<- select(rep_bill_df, bill_id, title)
#print(selected_rep_bill_df)
return(recent_votes)
percentage_other<- function(rep_id) {
uri_recent<- "https://api.propublica.org/congress/v1/house/votes/recent.json")
response_recent <- GET(uri_recent, add_headers('X-API-Key' = propublica_key))
response_text_recent <- content(response, "text")
text_format_recent <- fromJSON(response_text)
#Create data frame
recent_votes<- as.data.frame(text_format_recent$results)
#selected_rep_bill_df<- select(rep_bill_df, bill_id, title)
#print(selected_rep_bill_df)
}
percentage_other<- function(rep_id) {
uri_recent<- "https://api.propublica.org/congress/v1/house/votes/recent.json")
response_recent <- GET(uri_recent, add_headers('X-API-Key' = propublica_key))
response_text_recent <- content(response, "text")
text_format_recent <- fromJSON(response_text)
#Create data frame
recent_votes<- as.data.frame(text_format_recent$results)
#selected_rep_bill_df<- select(rep_bill_df, bill_id, title)
#print(selected_rep_bill_df)
}
percentage_other<- function(rep_id) {
uri_recent<- "https://api.propublica.org/congress/v1/house/votes/recent.json")
response_recent <- GET(uri_recent, add_headers('X-API-Key' = propublica_key))
response_text_recent <- content(response, "text")
text_format_recent <- fromJSON(response_text)
#Create data frame
recent_votes<- as.data.frame(text_format_recent$results)
#selected_rep_bill_df<- select(rep_bill_df, bill_id, title)
#print(selected_rep_bill_df)
}
percentage_other<- function(rep_id) {
uri_recent<- "https://api.propublica.org/congress/v1/house/votes/recent.json")
response_recent <- GET(uri_recent, add_headers('X-API-Key' = propublica_key))
response_text_recent <- content(response, "text")
text_format_recent <- fromJSON(response_text)
#Create data frame
#recent_votes<- as.data.frame(text_format_recent$results)
#selected_rep_bill_df<- select(rep_bill_df, bill_id, title)
#print(selected_rep_bill_df)
}
library(httr)
shiny::runApp('C:/Users/roshn/Documents/INFO201/ch16-shiny/exercise-5')
runApp('C:/Users/roshn/Documents/INFO201/INFO-201-Final-Project')
runApp('C:/Users/roshn/Documents/INFO201/INFO-201-Final-Project')
install.packages("DT")
# INFO 201 Final App
library("shiny")
library("dplyr")
library("ggplot2")
library("tidyr")
library("maps")
library("DT")
page_one <- tabPanel(
"First Page"
)
page_two <- tabPanel(
"Second Page"
)
page_three <- tabPanel(
"Third Page"
)
page_four <- tabPanel(
"Fourth Page"
)
my_ui <- navbarPage(
"My app",
page_one,
page_two,
page_three,
page_four
)
my_server <- function(input,output) {
}
shinyApp(ui = my_ui, server = my_server)
mean(trump_approval_filtered$approve)
#Load libraries
library(plyr)
library(jsonlite)
library(httr)
library(dplyr)
library(stringr)
library(tidyr)
#Donald Trump's Twitter data from 2017
trump_tweets <- read_json("data/2017_Trump_Twitter.json", simplifyVector = TRUE)
trump_tweets <- trump_tweets %>%
select(created_at,
text,
retweet_count,
favorite_count,
is_retweet)
#Donald Trump's approval rating
trump_approval <- read.csv("data/approval_polllist.csv", stringsAsFactors = FALSE)
trump_approval <- trump_approval %>%
select(poll_id,
startdate,
enddate,
pollster,
grade,
samplesize,
approve,
disapprove,
url)
#Preliminary Analysis
summary_twitter <- trump_tweets %>%
summarize(
"Total Tweets" = nrow(trump_tweets),
"Tweets from Trump" = nrow(trump_tweets) - sum(is_retweet),
"Average Retweet Count" = round(mean(retweet_count), digits = 0),
"Average Favorite Count" = mean(favorite_count)
)
#General Averages
# Returns the most common value from data set -- adapted from https://www.tutorialspoint.com/r/r_mean_median_mode.htm
find_mode <- function(data) {
unique <- unique(data)
unique[which.max(tabulate(match(data, unique)))]
}
average_tweets <-mean(trump_tweets$retweet_count)
pollsters <- as.data.frame(unique(trump_approval$pollster))
summary_approval <- trump_approval %>%
summarize(
"Total Pollsters" = nrow(pollsters),
"Most Common Grade" = find_mode(grade),
"Average Approval" = round(mean(approve), digits = 1),
"Max Approval" = round(max(approve), digits = 1),
"Min Approval" = round(min(approve), digits = 1),
"Standard Deviation of Approval" = round(sd(approve), digits = 1),
"Average Disapproval" = round(mean(disapprove), digits = 1),
"Max Dissapproval" = round(max(disapprove), digits = 1),
"Min Dissapproval" = round(min(disapprove), digits = 1),
"Standard Deviation of Dissapproval" = round(sd(disapprove), digits = 1)
)
#Answering Russia question
#Using as.Date function
trump_approval <- read.csv("data/approval_polllist.csv", stringsAsFactors = FALSE)
trump_approval_filtered <- trump_approval %>% filter(pollster == "Gallup") %>% select(enddate, approve)
enddate_2<- trump_approval_filtered$enddate %>% as.Date(format = "%m/%d/%y")
trump_approval_filtered<- mutate(trump_approval_filtered, enddate_2 = enddate_2)
trump_approval_filtered<- select(trump_approval_filtered, enddate = enddate_2, approve)
trump_tweets_date <- trump_tweets %>%
mutate(Date = as.Date(trimws(paste(substr(created_at, 4, 10), "2017")), format = "%b %d %Y"), num = 1) %>% select(text, retweet_count, favorite_count, Date)
#Search function for table
search_query<- function(query, output) {
equation<- str_detect(trump_tweets_date$text, query)
trump_tweets_keyword<- mutate(trump_tweets_date, keyword_present = equation)
trump_tweets_keyword<- filter(trump_tweets_keyword, trump_tweets_keyword$keyword_present == TRUE)
trump_tweets_keyword<- select(trump_tweets_keyword, text, retweet_count, favorite_count, Date)
trump_tweets_keyword
}
#mean(trump_approval_filtered$approve)
#Answering question #3
average_12_31<- trump_approval[1343:1345,]
average_12_31<- mean(average_12_31$approve)
#Answering Our Question #4
# A data frame representing the number of daily tweets during 2017 by President Trump
trump_tweet_frequency <- trump_tweets %>%
dplyr::mutate(
Date = as.Date(trimws(paste(substr(created_at, 4, 10), "2017")), "%b %d %Y")
, num = 1
) %>%
group_by(Date) %>%
dplyr::summarise(Frequency = sum(num))
# A data frame representing Trump's average daily approval ratings during 2017.
# The date in the new data frame is the same as the 'enddate' in the trump_approval data frame.
trump_daily_approval <- trump_approval %>%
dplyr::mutate(
Date = as.Date(enddate, "%m/%d/%y")
) %>%
group_by(Date) %>%
dplyr::summarize(approve = mean(approve),disapprove = mean(disapprove))
# A joined data frame with info from both of the above data frames
daily_approval_and_frequency <- inner_join(trump_tweet_frequency, trump_daily_approval, by = "Date")
approval_and_frequency_correlation <- cor(daily_approval_and_frequency$approve, daily_approval_and_frequency$Frequency)
#View(daily_approval_and_frequency)
# Trump Twitter Analysis
twitter_data <- as.data.frame(t(as.data.frame(strsplit(trump_tweets$created_at, " "), stringsAsFactors = FALSE)), stringsAsFactors = FALSE)
twitter_data <- twitter_data %>%
mutate(created_at = trump_tweets$created_at) %>%
left_join(trump_tweets, by = "created_at") %>%
select(V2, V3, V6, V4, created_at, text, retweet_count, favorite_count, is_retweet)
twitter_data <- twitter_data %>%
mutate(month = match(twitter_data$V2, month.abb), day = V3, year = V6, time = V4) %>%
select(month, day, year, time, created_at, text, retweet_count, favorite_count, is_retweet)
monthly_tweets <- group_by(twitter_data, month) %>%
dplyr::count() %>%
as.data.frame(stringAsVariable = FALSE) %>%
dplyr::mutate("Month" = month.name[month],
"Number of Tweets" = n) %>%
select("Month", "Number of Tweets")
monthly_tweet_count <- group_by(twitter_data, month) %>%
dplyr::count()
get_monthly_info <- function(given_month) {
tweets <- monthly_tweet_count$n[monthly_tweet_count$month == given_month]
date <- month.name[given_month]
avg_data <- twitter_data %>%
filter(month == given_month) %>%
dplyr::summarize(
num_days = as.numeric(max(day)),
total_tweets = as.numeric(n()),
most_retweeted = text[retweet_count == max(retweet_count)][1],
least_retweeted = text[retweet_count == min(retweet_count)][1],
most_favorited = text[favorite_count == max(favorite_count)][1],
least_favorited = text[favorite_count == min(favorite_count)][1]
)
avg_num_tweets <- round(avg_data$total_tweets / avg_data$num_days)
paste0("There were ", tweets, " tweets in ", date,
" 2017, with an average of ", avg_num_tweets, " tweets per day.")
}
mean(trump_approval_filtered$approve)
mean(trump_approval_filtered$approve)
# INFO 201 Final App
library("shiny")
library("plyr")
library("dplyr")
library("ggplot2")
library("tidyr")
library("maps")
library("DT")
# Gives us access to the data and analysis from a6
source("analysis_a6.R")
page_one <- tabPanel(
"Overview",
titlePanel("Trump's tweets and his approval rating during 2017"),
p("by Roshni Sinha, Michelle Ponting, Andy Straavaldson and John Reese -- Group AA2"),
HTML('<img src="donald_trump.jpg" alt="Donald Trump", height = "400", align = "center">'),
p("Donald Trump often takes to Twitter to share his thoughts with the American public.
As president of the United States, his duties and the perception of the American public are often
intertwined. Twitter, a social media platform used to share short posts, acts as a means of communication
between Trump and both his supporters and rivals, allowing others an insight to his mind and life in the
Oval Office. In this assignment, we will analyze the effect Trump's tweets had on his approval rating
in 2017. By comparing these two sets of data, we can gain broader knowledge of how social media is
used in politics.")
)
page_two <- tabPanel(
"Tweet interaction based on key words",
titlePanel("How using certain key words affect the amount of interactions a tweet gets"),
p("This will show which topics bring in the most likes and retweets among twitter users, and
will show which topics spark the most conversation and activity on twitter and what topics people
care the most about")
)
page_three <- tabPanel(
"Twitter Activity Analysis",
titlePanel("Analysis of President Trump's Twitter Activity in 2017"),
sidebarLayout(
sidebarPanel(
sliderInput(
inputId = "month",
label = "Month",
min = 1,
max = 12,
value = 1,
ticks = FALSE
),
h2(textOutput("monthname"))
),
mainPanel(
plotOutput("plotmontlytweets"),
h1(textOutput("twitterdata")),
tableOutput("tablemonthlytweets")
)
)
)
page_four <- tabPanel(
"Approval Rating and Tweeting Frequency", # Label for the tab in the navbar
titlePanel("How did changes in Trump's approval/disapproval rating affect how often he tweeted?"),
sidebarLayout(
sidebarPanel(
radioButtons(inputId = "approve", label = "Metric",choices = c("approve","disapprove")),
textOutput(outputId = "corr"),
p(""),
p("As can be seen, there exists a weak negative correlation between both Trump's
approval rating and tweeting frequency and a weak positive correlation between Trump's
disapproval rating and his tweeting frequency. Interestingly, the former correlation is stronger
than the latter. Perhaps this indicates that Trump pays more attention to his approval ratings than
his dissaproval ratings.")
),
mainPanel(
plotOutput(outputId = "frequency_plot"),
plotOutput(outputId = "date_plot"),
p(""),
p("- The frequency is the number of times that Donald Trump tweeted in a day"),
p("- The approval rating is average of all approval ratings released in a day.")
)
)
)
page_five <- tabPanel(
"Approval Rating and Tweet Content",
titlePanel("Tracking Trump's Tweets"),
sidebarLayout(
sidebarPanel(
textInput(
inputId = "query",
label = "Trump mentioned:"
),
p("This page allows the user to search any term Trump mentions and view his approval rating at the time he said it. Some common terms are 'Russia' and 'Democrats'. There seems to be no clear correlation between Trump's tweets about Russia and his approval rating.")
),
mainPanel(
plotOutput("plot_query"),
tableOutput("searchquery")
)
)
)
my_ui <- navbarPage(
"Tweets of Approval",
page_one,
page_two,
page_three,
page_four,
page_five
)
my_server <- function(input,output) {
output$frequency_plot <- renderPlot({
ggplot(data = daily_approval_and_frequency,mapping = aes_string(x = "Frequency", y = input$approve)) +
geom_point() +
geom_smooth(method = "lm")
})
output$date_plot <- renderPlot({
apr <- toString(input$approve)
ggplot(data = daily_approval_and_frequency)+
geom_point(mapping = aes_string(x = "Date", y = apr, color = "Frequency"))
})
output$corr <- renderText({
tex <- ""
if (input$approve == "approve") {
x <- as.numeric(daily_approval_and_frequency$approve)
y <- as.numeric(daily_approval_and_frequency$Frequency)
freq_cor <- round(cor(x,y),2)
tex <- paste("The correlation between approval rating and frequency is", paste0(freq_cor, "."))
} else {
x <- as.numeric(daily_approval_and_frequency$disapprove)
y <- as.numeric(daily_approval_and_frequency$Frequency)
freq_cor <- round(cor(x,y),2)
tex <- paste("The correlation between disapproval rating and frequency is", paste0(freq_cor, "."))
}
tex
})
# Michelle Q data
output$plotmontlytweets <- renderPlot({
data <- twitter_data
plot.data <- data %>% filter(month == input$month)
ggplot(data = plot.data) +
geom_point(mapping = aes(x = day, y = time, color = is_retweet)) +
scale_y_discrete(breaks = NULL) +
labs(
title = paste("All of Donald Trump's Tweets in", month.name[input$month]),
y = "Time of Day (00:00 to 24:00)",
x = "Day of the Month",
color = "Is it a Retweet?"
)
})
output$twitterdata <- renderText({
twitter_info <- get_monthly_info(input$month)
twitter_info
})
output$monthname <- renderText({
month <- month.name[input$month]
month
})
output$tablemonthlytweets <- renderTable({
table <- monthly_tweets
table
})
#Roshni's data
output$searchquery <- renderTable({
if (input$query == input$query) {
plot.data <- search_query(input$query)
} else {
plot.data <- trump_tweets_date
}
})
output$plot_query<- renderPlot({
if (input$query == input$query) {
plot.data <- trump_approval_filtered
}
ggplot(trump_approval_filtered, aes(x = enddate, y = approve)) + geom_line(group = 1, color = "blue") + geom_vline(xintercept = plotquery(input$query), color = "red")
})
}
shinyApp(ui = my_ui, server = my_server)
mean(trump_approval_filtered$approve)
mean(trump_approval_filtered$approve)
trump_approval <- read.csv("data/approval_polllist.csv", stringsAsFactors = FALSE)
trump_approval_filtered <- trump_approval %>% filter(pollster == "Gallup") %>% select(enddate, approve)
enddate_2<- trump_approval_filtered$enddate %>% as.Date(format = "%m/%d/%y")
trump_approval_filtered<- mutate(trump_approval_filtered, enddate_2 = enddate_2)
trump_approval_filtered<- select(trump_approval_filtered, enddate = enddate_2, approve)
setwd("C:/Users/roshn/Documents/INFO201/a6-collaboration-Johnreese212")
trump_approval <- read.csv("data/approval_polllist.csv", stringsAsFactors = FALSE)
trump_approval_filtered <- trump_approval %>% filter(pollster == "Gallup") %>% select(enddate, approve)
enddate_2<- trump_approval_filtered$enddate %>% as.Date(format = "%m/%d/%y")
trump_approval_filtered<- mutate(trump_approval_filtered, enddate_2 = enddate_2)
trump_approval_filtered<- select(trump_approval_filtered, enddate = enddate_2, approve)
mean(trump_approval_filtered$approve)
runApp('C:/Users/roshn/Documents/INFO201/INFO-201-Final-Project')
setwd("C:/Users/roshn/Documents/INFO201/INFO-201-Final-Project")
runApp()
runApp()
